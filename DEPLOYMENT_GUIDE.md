# RAGFlow ä¿®æ”¹éƒ¨ç½²æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

ç”±äº RAGFlow ä½¿ç”¨ Docker Compose éƒ¨ç½²ï¼Œä»£ç è¢«æ‰“åŒ…åœ¨é•œåƒä¸­ã€‚æœ¬æŒ‡å—æä¾›ä¸¤ç§æ–¹æ³•è®©æ‚¨çš„ä»£ç ä¿®æ”¹ç”Ÿæ•ˆã€‚

## ğŸ¯ æ–¹æ³•ä¸€ï¼šå¼€å‘æ¨¡å¼ï¼ˆæ¨èï¼Œæœ€å¿«ï¼‰

### ä¼˜ç‚¹
- âœ… æ— éœ€é‡æ–°æ„å»ºé•œåƒ
- âœ… ä¿®æ”¹ç«‹å³ç”Ÿæ•ˆ
- âœ… é€‚åˆå¿«é€Ÿè¿­ä»£å¼€å‘
- âœ… é‡å¯å®¹å™¨åªéœ€å‡ ç§’é’Ÿ

### æ­¥éª¤

1. **ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆå·²å®Œæˆï¼‰**
   
   `docker/docker-compose.yml` å·²ç»æ·»åŠ äº†ä»£ç ç›®å½•æŒ‚è½½ï¼š
   ```yaml
   volumes:
     - ../api:/ragflow/api
     - ../rag:/ragflow/rag
     - ../deepdoc:/ragflow/deepdoc
     - ../agent:/ragflow/agent
     - ../graphrag:/ragflow/graphrag
     - ../agentic_reasoning:/ragflow/agentic_reasoning
   ```

2. **é‡å¯æœåŠ¡**

   **æ–¹å¼ Aï¼šä½¿ç”¨å¿«æ·è„šæœ¬**
   ```bash
   cd /mnt/data6t/wangxiaojing/rag_flow/docker
   ./restart-dev.sh
   ```

   **æ–¹å¼ Bï¼šæ‰‹åŠ¨é‡å¯**
   ```bash
   cd /mnt/data6t/wangxiaojing/rag_flow/docker
   docker-compose down
   docker-compose up -d
   ```

3. **éªŒè¯ä¿®æ”¹**
   ```bash
   # æŸ¥çœ‹æ—¥å¿—ç¡®è®¤æœåŠ¡æ­£å¸¸å¯åŠ¨
   docker-compose logs -f ragflow
   
   # è¿›å…¥å®¹å™¨æ£€æŸ¥ä»£ç 
   docker exec -it ragflow-server bash
   cat /ragflow/api/apps/document_app.py | grep "binary_data_warnings"
   ```

### æ³¨æ„äº‹é¡¹

âš ï¸ **å¼€å‘æ¨¡å¼æ³¨æ„äº‹é¡¹ï¼š**
- æœ¬åœ°ä»£ç ä¿®æ”¹ä¼šç›´æ¥å½±å“å®¹å™¨å†…çš„ä»£ç 
- é€‚åˆå¼€å‘è°ƒè¯•ï¼Œä¸å»ºè®®ç”Ÿäº§ç¯å¢ƒä½¿ç”¨
- å¦‚æœä¿®æ”¹äº†ä¾èµ–ï¼ˆpyproject.tomlï¼‰ï¼Œä»éœ€é‡æ–°æ„å»ºé•œåƒ

---

## ğŸ­ æ–¹æ³•äºŒï¼šç”Ÿäº§æ¨¡å¼ï¼ˆé‡æ–°æ„å»ºé•œåƒï¼‰

### é€‚ç”¨åœºæ™¯
- ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- ä¿®æ”¹äº†ä¾èµ–é¡¹
- éœ€è¦å®Œæ•´çš„é•œåƒåˆ†å‘

### æ­¥éª¤

1. **æ„å»ºæ–°é•œåƒ**
   ```bash
   cd /mnt/data6t/wangxiaojing/rag_flow
   
   # æ„å»ºé•œåƒï¼ˆæ ‡å‡†ç‰ˆï¼‰
   docker build -t ragflow:custom-fix .
   
   # æˆ–æ„å»ºè½»é‡ç‰ˆ
   docker build --build-arg LIGHTEN=1 -t ragflow:custom-fix-slim .
   ```

2. **ä¿®æ”¹ç¯å¢ƒå˜é‡**
   
   ç¼–è¾‘ `/mnt/data6t/wangxiaojing/rag_flow/docker/.env`ï¼š
   ```bash
   # å°† RAGFLOW_IMAGE æ”¹ä¸ºæ‚¨æ„å»ºçš„é•œåƒ
   RAGFLOW_IMAGE=ragflow:custom-fix
   ```

3. **é‡å¯æœåŠ¡**
   ```bash
   cd /mnt/data6t/wangxiaojing/rag_flow/docker
   docker-compose down
   docker-compose up -d
   ```

### æ„å»ºæ—¶é—´ä¼°ç®—
- é¦–æ¬¡æ„å»ºï¼šçº¦ 20-30 åˆ†é’Ÿï¼ˆå–å†³äºç½‘ç»œé€Ÿåº¦ï¼‰
- åç»­æ„å»ºï¼šçº¦ 5-10 åˆ†é’Ÿï¼ˆDocker ä¼šä½¿ç”¨ç¼“å­˜ï¼‰

---

## ğŸ” éªŒè¯ä¿®æ”¹æ˜¯å¦ç”Ÿæ•ˆ

### 1. æ£€æŸ¥æ—¥å¿—åŠŸèƒ½
```bash
# æµ‹è¯•ä¸Šä¼ æ–‡ä»¶ï¼Œè§‚å¯Ÿæ˜¯å¦æœ‰æ–°çš„æ—¥å¿—è¾“å‡º
docker-compose logs -f ragflow | grep "binary_data"
```

### 2. æ£€æŸ¥ä»£ç å†…å®¹
```bash
docker exec -it ragflow-server bash -c "grep -A 5 'binary_data_warnings' /ragflow/api/apps/document_app.py"
```

### 3. æµ‹è¯•ä¸Šä¼ åŠŸèƒ½
ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶åˆ°çŸ¥è¯†åº“ï¼ŒæŸ¥çœ‹ï¼š
- æœåŠ¡å™¨æ—¥å¿—ä¸­æ˜¯å¦å‡ºç°äºŒè¿›åˆ¶æ•°æ®è­¦å‘Š
- å“åº”æ¶ˆæ¯ä¸­æ˜¯å¦åŒ…å«æ–‡ä»¶å

---

## ğŸš¨ å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1ï¼šä¿®æ”¹ä¸ç”Ÿæ•ˆ
```bash
# ç¡®è®¤å®¹å™¨æ­£åœ¨ä½¿ç”¨æŒ‚è½½çš„ç›®å½•
docker inspect ragflow-server | grep -A 10 Mounts

# å¼ºåˆ¶é‡å¯
docker-compose down -v  # æ³¨æ„ï¼š-v ä¼šåˆ é™¤å·æ•°æ®
docker-compose up -d
```

### é—®é¢˜ 2ï¼šæƒé™é—®é¢˜
```bash
# ä¿®å¤æ–‡ä»¶æƒé™
sudo chown -R $USER:$USER /mnt/data6t/wangxiaojing/rag_flow/api
```

### é—®é¢˜ 3ï¼šå®¹å™¨å¯åŠ¨å¤±è´¥
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
docker-compose logs ragflow

# æ£€æŸ¥é…ç½®æ–‡ä»¶
docker-compose config
```

### é—®é¢˜ 4ï¼šPython æ¨¡å—æœªæ‰¾åˆ°
```bash
# å¦‚æœæŒ‚è½½åå‡ºç°æ¨¡å—å¯¼å…¥é—®é¢˜ï¼Œå¯èƒ½éœ€è¦é‡æ–°å®‰è£…
docker exec -it ragflow-server bash
cd /ragflow
uv sync --python 3.10
```

---

## ğŸ“Š å¯¹æ¯”æ€»ç»“

| ç‰¹æ€§ | å¼€å‘æ¨¡å¼ï¼ˆæŒ‚è½½ä»£ç ï¼‰ | ç”Ÿäº§æ¨¡å¼ï¼ˆé‡å»ºé•œåƒï¼‰ |
|------|-------------------|-------------------|
| ç”Ÿæ•ˆé€Ÿåº¦ | âš¡ ç§’çº§ï¼ˆé‡å¯å®¹å™¨ï¼‰ | ğŸ¢ åˆ†é’Ÿçº§ï¼ˆé‡å»ºé•œåƒï¼‰ |
| é€‚ç”¨åœºæ™¯ | å¼€å‘è°ƒè¯• | ç”Ÿäº§éƒ¨ç½² |
| å¯ç§»æ¤æ€§ | âŒ ä¾èµ–æœ¬åœ°ä»£ç  | âœ… å®Œæ•´é•œåƒ |
| ä¿®æ”¹ä¾èµ– | âŒ éœ€é‡å»ºé•œåƒ | âœ… åŒ…å«æ‰€æœ‰ä¾èµ– |
| æ¨èç­‰çº§ | â­â­â­â­â­ å¼€å‘ | â­â­â­â­â­ ç”Ÿäº§ |

---

## ğŸ“ ä¿®æ”¹è®°å½•

### æœ¬æ¬¡ä¿®æ”¹å†…å®¹
- æ–‡ä»¶ï¼š`api/apps/document_app.py`
- ä¿®æ”¹ï¼šæ·»åŠ äºŒè¿›åˆ¶æ•°æ®æ£€æµ‹å’Œæ—¥å¿—è®°å½•
- åŠŸèƒ½ï¼šå½“æ–‡ä»¶åŒ…å«äºŒè¿›åˆ¶æ•°æ®æ—¶ï¼Œè®°å½•æ—¥å¿—å¹¶æ˜¾ç¤ºæ–‡ä»¶åï¼Œä½†ç»§ç»­å¤„ç†å…¶ä»–æ–‡ä»¶

### å…³é”®æ”¹åŠ¨
1. æ·»åŠ  `logging` æ¨¡å—å¯¼å…¥
2. åˆå§‹åŒ– logger
3. å¢åŠ  `binary_data_warnings` åˆ—è¡¨æ”¶é›†è­¦å‘Š
4. éå†æ–‡ä»¶æ—¶æ£€æµ‹äºŒè¿›åˆ¶æ•°æ®å¹¶è®°å½•æ—¥å¿—
5. åœ¨å“åº”ä¸­åŒ…å«è­¦å‘Šä¿¡æ¯

---

## ğŸ“ å¿«é€Ÿå‚è€ƒ

```bash
# å¼€å‘æ¨¡å¼å¿«é€Ÿå¯åŠ¨
cd /mnt/data6t/wangxiaojing/rag_flow/docker
./restart-dev.sh

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker-compose logs -f ragflow

# è¿›å…¥å®¹å™¨è°ƒè¯•
docker exec -it ragflow-server bash

# é‡å¯å•ä¸ªæœåŠ¡
docker-compose restart ragflow

# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose ps

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose down
```

---

## ğŸ’¡ å»ºè®®

**å½“å‰å»ºè®®ï¼šä½¿ç”¨æ–¹æ³•ä¸€ï¼ˆå¼€å‘æ¨¡å¼ï¼‰**

ç†ç”±ï¼š
1. âœ… æ‚¨çš„ä¿®æ”¹å·²å®Œæˆï¼Œæ— éœ€å†æ¬¡ä¿®æ”¹ä»£ç 
2. âœ… åªä¿®æ”¹äº† Python ä»£ç ï¼Œæœªæ¶‰åŠä¾èµ–å˜æ›´
3. âœ… å¯ä»¥å¿«é€ŸéªŒè¯ä¿®å¤æ•ˆæœ
4. âœ… å¦‚éœ€ç»§ç»­è°ƒè¯•ï¼Œå¯ç«‹å³ä¿®æ”¹æœ¬åœ°æ–‡ä»¶

**ä¸‹ä¸€æ­¥ï¼š**
```bash
cd /mnt/data6t/wangxiaojing/rag_flow/docker
./restart-dev.sh
```

ç­‰å¾…å®¹å™¨å¯åŠ¨å®Œæˆåï¼Œæµ‹è¯•æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œè§‚å¯Ÿæ—¥å¿—è¾“å‡ºã€‚



